#!/usr/bin/perl
use strict;

use QuizMaker::Test;

#
# qzm-view_test
#
# Outputs a complete test ready to be processed with LaTeX.
#

# {{{ process arguments (@ARGV)

my $usage = "a.out <test name>";

unless (@ARGV == 1) {
    die "$usage\n";
}

my $test_file = shift @ARGV;

# }}}

my $qzt = QuizMaker::Test->load_file($test_file)
	or die "unable to load test\n";

# be careful with the escapes!

my $proc_name = (split /\//, $0)[-1];

print "% This file was generated by $proc_name\n";

print <<'HEADER1';

%\documentclass{exam}
\documentclass[noanswers]{exam}

\usepackage{multicol}
\usepackage{ulem}
\usepackage{graphicx}
\usepackage{amsmath}

\parindent=0pt
%\usepackage{graphicx}

\begin{document}


% choose one or the other,
% or leave configured by \documentclass
%\printanswers
%\noprintanswers

HEADER1

my $class = $qzt->{'class'};
my $term = $qzt->{'term'};
my $title = $qzt->{'title'};
print <<"HEADER2";

\\begin{tabular}{l r}
Name: \\uline{\\hspace{200pt}} \\hspace{160pt} & $class \\\\
      & $term \\\\
      & $title \\\\
\\end{tabular}

HEADER2

print '
\vspace{10pt}

';

print $qzt->{'instructions'};

print '
\vspace{5pt}
';

print '
\begin{questions}
';

my @problems = @{$qzt->{problems}};

for (my $i = 0; $i < @problems; $i++) {
	#my $n = $i + 1;  # problem number
	my $qzp = $problems[$i];

	print "\n\\question ";
	#print "$n.)  ";
	print $qzp->{question};

	print "\n";
	print '\vspace*{' . $qzp->{workspace} . '}';
	print "\n";

	print "\n\\begin{solution}\n";
	print $qzp->{answer};
	print "\n\\end{solution}\n";

}

print '
\end{questions}

\end{document}
';

